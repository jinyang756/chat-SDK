<!doctype html>
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <!-- 基本设置 -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>客服系统</title>
    
    <!-- 优先引入Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <!-- 性能优化 -->
    <meta http-equiv="Cache-Control" content="public, max-age=31536000">
    <meta name="format-detection" content="telephone=no">
    
    <!-- 性能优化 -->
    <meta http-equiv="Cache-Control" content="public, max-age=31536000">
    <meta name="format-detection" content="telephone=no">
    
    <!-- DNS预解析 -->
    <link rel="dns-prefetch" href="//mdclink.xianshangkefu.com">
    
    <!-- 提前建立连接 -->
    <link rel="preconnect" href="//mdclink.xianshangkefu.com" crossorigin>
</head>
<body>
    <script type="text/javascript">
        // 保留原客服链接代码不变
        window._MICHAT = window._MICHAT || function () { (_MICHAT.a = _MICHAT.a || []).push(arguments) };
        _MICHAT("cptid", "e773425b58e01513a5"); 
        _MICHAT("host", "mdclink.xianshangkefu.com"); 
        (function (m, d, q, j, s) { 
            j = d.createElement(q),s = d.getElementsByTagName(q)[0]; 
            j.async = true; 
            j.charset ="UTF-8"; 
            j.src = ("https:" == document.location.protocol ? "https://" : "http://") + "mdclink.xianshangkefu.com/Web/js/loader.js"; 
            s.parentNode.insertBefore(j, s); 
        })(window, document, "script");
    </script>
    
    <!-- 调试信息输出 -->
    <script>console.log('客服系统加载成功');</script>
    
    <!-- 领取指标大礼包按钮（图标+文字版） -->
    <div id="giftPackageButton" 
        style="
            position: fixed !important;
            top: 50% !important;
            right: 20px !important;
            transform: translateY(-50%) !important;
            z-index: 2147483647 !important;
            background: linear-gradient(135deg, #4A90E2, #5C6BC0) !important;
            color: white !important;
            padding: 12px 20px !important;
            border: none !important;
            border-radius: 25px !important;
            cursor: pointer !important;
            font-size: 14px !important;
            font-weight: bold !important;
            display: flex !important;
            align-items: center !important;
            gap: 8px !important;
            box-shadow: 0 4px 20px rgba(74, 144, 226, 0.4) !important;
            pointer-events: auto !important;
            will-change: transform !important;
            animation: subtleGlow 3s infinite alternate !important;
            min-width: 120px !important;
            transition: all 0.3s ease !important;
        "
    >
        <i class="fa fa-bar-chart" aria-hidden="true" style="font-size: 16px !important;"></i>
        <span>指标大礼包</span>
    </div>
    
    <!-- 为礼包按钮添加动画和样式 -->
    <style>
        @keyframes subtleGlow {
            0% {
                box-shadow: 0 4px 20px rgba(74, 144, 226, 0.4);
                background: linear-gradient(135deg, #4A90E2, #5C6BC0);
            }
            100% {
                box-shadow: 0 6px 25px rgba(74, 144, 226, 0.6);
                background: linear-gradient(135deg, #5BA3F3, #6D82E3);
            }
        }
        
        #giftPackageButton:hover {
            transform: scale(1.05) translateY(-50%) !important;
            box-shadow: 0 8px 30px rgba(74, 144, 226, 0.7) !important;
        }
        
        #giftPackageButton:active {
            transform: scale(0.98) translateY(-50%) !important;
        }
        
        /* 响应式设计：在小屏幕上自动调整样式 */
        @media (max-width: 768px) {
            #giftPackageButton {
                right: 10px !important;
                font-size: 12px !important;
                padding: 10px 16px !important;
                min-width: auto !important;
            }
        }
    </style>
    
    <!-- 礼包按钮点击事件 -->
    <script>
        document.getElementById('giftPackageButton').addEventListener('click', function() {
            window.location.href = 'qiliantong-download.html';
        });
    </script>

    <!-- 页面加载完成 -->
    <script>
        window.addEventListener('load', function() {
            console.log('页面加载完成');
        });
    </script>
    
    <!-- 礼包按钮防御机制 -->
    <script>
        // 核心防御机制：确保礼包按钮不被删除或隐藏
        function defendGiftButton() {
            const giftButton = document.getElementById('giftPackageButton');
            
            // 防御1：按钮被删除 → 立即重建
            if (!giftButton) {
                const newGiftButton = document.createElement('div');
                newGiftButton.id = 'giftPackageButton';
                newGiftButton.innerHTML = '<i class="fa fa-bar-chart" aria-hidden="true" style="font-size: 16px !important;"></i><span>指标大礼包</span>';
                newGiftButton.style.cssText = `
                    position: fixed !important;
                    top: 50% !important;
                    right: 20px !important;
                    transform: translateY(-50%) !important;
                    z-index: 2147483647 !important;
                    background: linear-gradient(135deg, #4A90E2, #5C6BC0) !important;
                    color: white !important;
                    padding: 12px 20px !important;
                    border: none !important;
                    border-radius: 25px !important;
                    cursor: pointer !important;
                    font-size: 14px !important;
                    font-weight: bold !important;
                    display: flex !important;
                    align-items: center !important;
                    gap: 8px !important;
                    box-shadow: 0 4px 20px rgba(74, 144, 226, 0.4) !important;
                    pointer-events: auto !important;
                    will-change: transform !important;
                    animation: subtleGlow 3s infinite alternate !important;
                    min-width: 120px !important;
                    transition: all 0.3s ease !important;
                `;
                newGiftButton.onclick = function() {
                    window.location.href = 'qiliantong-download.html';
                };
                document.body.appendChild(newGiftButton);
            }
            
            // 防御2：按钮被隐藏 → 强制显示
            if (giftButton && (giftButton.style.display === 'none' || giftButton.style.visibility === 'hidden' || giftButton.style.opacity === '0')) {
                giftButton.style.display = 'flex !important';
                giftButton.style.visibility = 'visible !important';
                giftButton.style.opacity = '1 !important';
            }
            
            // 防御3：层级被覆盖 → 重置最高层级
            if (giftButton && parseInt(giftButton.style.zIndex) < 2147483647) {
                giftButton.style.zIndex = '2147483647 !important';
            }
        }
        
        // 高频监控：每50ms检查一次
        const checkInterval = setInterval(defendGiftButton, 50);
        
        // 页面加载完成后立即检查
        window.addEventListener('load', () => {
            defendGiftButton();
            // 延迟1秒再检查一次（应对可能的DOM操作）
            setTimeout(defendGiftButton, 1000);
        });
        
        // 监听DOM变化，确保按钮不被删除
        document.addEventListener('DOMNodeInserted', (e) => {
            // 若有新元素插入，检查按钮状态
            defendGiftButton();
        });
        
        // 防误删机制：重写可能删除按钮的DOM方法
        const originalRemoveChild = Node.prototype.removeChild;
        Node.prototype.removeChild = function(child) {
            if (child.id === 'giftPackageButton') {
                return child; // 假装删除，实际保留
            }
            return originalRemoveChild.call(this, child);
        };
        
        const originalSetAttribute = Element.prototype.setAttribute;
        Element.prototype.setAttribute = function(name, value) {
            if (this.id === 'giftPackageButton' && name === 'style' && 
                (value.includes('display:none') || value.includes('visibility:hidden'))) {
                return; // 忽略隐藏样式
            }
            return originalSetAttribute.call(this, name, value);
        };
    </script>
</body>
</html>