<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OnlineChat客服系统</title>
    <style>
        /* 基础样式 - 保留原有米多客挂件风格 */
        .midok-sidebar {
            position: fixed;
            right: 30px;
            bottom: 30px;
            z-index: 9999;
        }
        
        .midok-btn {
            width: 60px;
            height: 60px;
            background-color: #1E88E5;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(30, 136, 229, 0.4);
            transition: all 0.3s ease;
            border: none;
            outline: none;
        }
        
        .midok-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 16px rgba(30, 136, 229, 0.6);
        }
        
        .midok-btn-icon {
            color: white;
            font-size: 24px;
        }
    </style>
    <!-- 使用Font Awesome图标 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- 主客服按钮 -->
    <div class="midok-sidebar">
        <button id="midokMainBtn" class="midok-btn">
            <i class="midok-btn-icon fas fa-comment-dots"></i>
        </button>
    </div>

    <script>
        // 生成随机访客ID
        function generateVisitorId() {
            // 尝试从localStorage获取已有的访客ID
            let visitorId = localStorage.getItem('onlineChatVisitorId');
            if (!visitorId) {
                // 生成新的访客ID
                visitorId = 'visitor_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('onlineChatVisitorId', visitorId);
            }
            return visitorId;
        }
        
        // 获取OnlineChat客服URL
        function getOnlineChatUrl(visitorId) {
            // 这里可以根据需要配置您的OnlineChat服务器地址
            // 注意：实际部署时需要替换为您自己的OnlineChat服务地址
            return 'https://example-chat-service.com/chat?uid=' + visitorId;
        }
        
        // 打开客服窗口
        function openChatWindow() {
            const visitorId = generateVisitorId();
            const chatUrl = getOnlineChatUrl(visitorId);
            
            // 使用新窗口打开客服页面，有效避免跨域限制
            window.open(chatUrl, '_blank', 'width=800,height=700,top=100,left=100');
        }
        
        // 初始化事件监听
        function initEventListeners() {
            const mainBtn = document.getElementById('midokMainBtn');
            
            // 主按钮点击事件 - 直接打开客服窗口
            mainBtn.addEventListener('click', function(e) {
                e.stopPropagation();
                openChatWindow();
            });
        }
        
        // 页面加载完成后初始化
        document.addEventListener('DOMContentLoaded', function() {
            initEventListeners();
            
            // 直接让域名最优级加载客服系统
            // 页面加载完成后自动打开客服窗口
            openChatWindow();
        });
    </script>
</body>
</html>